ุฌูุณู ฒฑ - ููุฏููโุง ุจุฑ ุณุงุฎุช ูู ูพุฑูฺู ุจุง ูพุงฺฏุงู ุฏุงุฏู
ุฏุฑ ุงู ุฌูุณูุ ฺฉ ูพุฑูฺู ุณุงุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ ูพุงฺฏุงู ุฏุงุฏู (Database) ุดุฑูุน ูโุดูุฏ ฺฉู ุฏุฑ ุขู ููุงูู ูพุงูโุง ูุงููุฏ ุฌุฏููโูุงุ ฺฉูุฏ ุฎุงุฑุฌ (Foreign Key) ู ุงูุฏฺฉุณ (Index) ููุฑุฏ ุจุฑุฑุณ ูุฑุงุฑ ูโฺฏุฑุฏ.

๐ฆ ุณุงุฎุช ุฌุฏุงูู ูพุงฺฏุงู ุฏุงุฏู
ุงุจุชุฏุง ุฏู ุฌุฏูู ุงุตู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุณุงุฎุชู ูโุดููุฏ:

1. ุฌุฏูู notes
   sql
   Copy
   Edit
   CREATE TABLE notes (
   id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
   body TEXT
   ) ENGINE=InnoDB;
   id: ุดูุงุฑู ุงุฏุฏุงุดุช (ฺฉูุฏ ุงุตู - PRIMARY KEY)

body: ูุชู ุงุฏุฏุงุดุช

2. ุฌุฏูู users
   sql
   Copy
   Edit
   CREATE TABLE users (
   id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
   name NVARCHAR(255),
   email VARCHAR(255)
   ) ENGINE=InnoDB;
   id: ุดูุงุฑู ฺฉุงุฑุจุฑ (ฺฉูุฏ ุงุตู)

name: ูุงู ฺฉุงุฑุจุฑ

email: ุงูู ฺฉุงุฑุจุฑ

๐ ุงุถุงููโฺฉุฑุฏู ุงูุฏฺฉุณ (Index) ุจู ุงูู ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชฺฉุฑุงุฑ ุจูุฏู
ุจุฑุง ุงูฺฉู ุงูู ูุฑ ฺฉุงุฑุจุฑ ฺฉุชุง ุจุงุดุฏุ ฺฉ ุงูุฏฺฉุณ ฺฉุชุง ุฑู ููุฏ email ูุฑุงุฑ ูโุฏูู:

sql
Copy
Edit
CREATE UNIQUE INDEX email_index ON users (email);
๐ ุงุถุงูู ฺฉุฑุฏู ฺฉูุฏ ุฎุงุฑุฌ ุจู ุฌุฏูู notes
ุจุฑุง ุงุฑุชุจุงุท ุจู ุงุฏุฏุงุดุชโูุง ู ฺฉุงุฑุจุฑุงูุ ฺฉ ููุฏ ุฌุฏุฏ ุจู ุฌุฏูู notes ุงุถุงูู ูโฺฉูู:

sql
Copy
Edit
ALTER TABLE notes ADD COLUMN user_id INT UNSIGNED;
ู ุณูพุณ ุงู ููุฏ ุฑุง ุจู ุนููุงู ฺฉูุฏ ุฎุงุฑุฌ ุชุนุฑู ูโฺฉูู:

sql
Copy
Edit
ALTER TABLE notes
ADD CONSTRAINT fk_user_note
FOREIGN KEY (user_id)
REFERENCES users(id);
ูฺฉุชู ููู: ููุน ุฏุงุฏู user_id ุจุงุฏ ฺฉุงููุงู ูุดุงุจู ุจุง users.id ุจุงุดุฏ (ูุซูุงู ูุฑ ุฏู INT UNSIGNED) ุชุง ฺฉูุฏ ุฎุงุฑุฌ ุจู ุฏุฑุณุช ุณุงุฎุชู ุดูุฏ.

๐งช ุชุณุช ฺฉุฑุฏู ุงุฑุชุจุงุท ฺฉูุฏ ุฎุงุฑุฌ
ุจุฑุง ุชุณุช ุงุฑุชุจุงุท ุจู ุฌุฏููโูุง:

ฺฉ ุฑฺฉูุฑุฏ ุฏุฑ ุฌุฏูู users ูุงุฑุฏ ูโฺฉูู.

ฺฉ ุงุฏุฏุงุดุช (note) ุจุง user_id ููุงู ฺฉุงุฑุจุฑ ูุงุฑุฏ ูโฺฉูู.

ุงฺฏุฑ ุชูุงุด ฺฉูู ุงุฏุฏุงุดุช ุจุง user_id ูุงูุนุชุจุฑ ูุงุฑุฏ ฺฉูู ุง ฺฉุงุฑุจุฑ ุฑุง ุญุฐู ฺฉูู ฺฉู ุงุฏุฏุงุดุช ุฏุงุฑุฏุ ุฎุทุง ุฎูุงูู ฺฏุฑูุช.

๐งน ุญุฐู ุง ูุงุฑุฏ ฺฉุฑุฏู ุงุทูุงุนุงุช ุจู ุฌุฏูู notes
ุฏุฑ ุทูู ุขููุฒุดุ ุงุทูุงุนุงุช ูุงุฑุฏ ู ุณูพุณ ูพุงฺฉ ูโุดููุฏ ุชุง ููููู ฺฉูุฏ ุฎุงุฑุฌ ู ูุงุจุณุชฺฏ ุจู ุฏุงุฏูโูุง ุจูโุตูุฑุช ุนูู ุชูุถุญ ุฏุงุฏู ุดูุฏ.

๐ ูฺฉุงุช ููู
ููฺฏุงู ุงุณุชูุงุฏู ุงุฒ ฺฉูุฏ ุฎุงุฑุฌุ ูุทูุฆู ุดูุฏ ูุฑ ุฏู ุฌุฏูู ุงุฒ ููุชูุฑ InnoDB ุงุณุชูุงุฏู ูโฺฉููุฏ.

ูุงู ููุฏูุงุ ููุน ุฏุงุฏูโูุง ู ุชุฑุชุจ ุณุงุฎุช ุฌุฏููโูุง ุจุงุฏ ุฏูู ุจุงุดุฏ.

ฺฉูุฏ ุฎุงุฑุฌ ููุท ุฒูุงู ูุงุจู ุงุถุงููโุดุฏู ุงุณุช ฺฉู ุฌุฏูู ููุตุฏ ุฏุงุฑุง ฺฉูุฏ ุงุตู (Primary Key) ุง ุงูุฏฺฉุณ ฺฉุชุง (Unique Index) ุจุงุดุฏ.

ุชูุถุญ ฺฉุงูู ุฏุณุชูุฑุงุช SQL ุงุณุชูุงุฏูโุดุฏู ุฏุฑ ุฌูุณู ฒฑ
ุฏุฑ ุงู ุจุฎุดุ ุชูุงู ุฏุณุชูุฑุงุช SQL ฺฉู ุฏุฑ ุฌูุณู ฒฑ ุงุณุชูุงุฏู ุดุฏุ ุจูโุตูุฑุช ฺฉุงูู ู ุฎุทโุจูโุฎุท ุชูุถุญ ุฏุงุฏู ูโุดูุฏ ุชุง ุจุฑุง ุงูุฑุงุฏ ุชุงุฒูโฺฉุงุฑ ฺฉุงููุงู ูุงุจูโููู ุจุงุดุฏ.

โ CREATE TABLE โ ุณุงุฎุช ุฌุฏูู ุฌุฏุฏ
sql
Copy
Edit
CREATE TABLE notes (
id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
body TEXT
) ENGINE=InnoDB;
ุงู ุฏุณุชูุฑ ฺฉ ุฌุฏูู ุจู ูุงู notes ุงุฌุงุฏ ูโฺฉูุฏ:

id INT UNSIGNED: ฺฉ ุนุฏุฏ ุตุญุญ ูุซุจุช ุงุณุช ฺฉู ุจู ุนููุงู ุดูุงุณู (ID) ูุฑ ุงุฏุฏุงุดุช ุงุณุชูุงุฏู ูโุดูุฏ.

AUTO_INCREMENT: ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุจู ูุฑ ุฑฺฉูุฑุฏ ุฌุฏุฏ ฺฉ ุดูุงุฑู ฺฉุชุง ูโุฏูุฏ.

PRIMARY KEY: ุงู ููุฏ ุฑุง ุจู ุนููุงู ฺฉูุฏ ุงุตู ุฌุฏูู ูุดุฎุต ูโฺฉูุฏ.

body TEXT: ูุชู ุงุฏุฏุงุดุช ุฑุง ุฐุฎุฑู ูโฺฉูุฏ.

ENGINE=InnoDB: ููุน ููุชูุฑ ูพุงฺฏุงู ุฏุงุฏู. ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ฺฉูุฏ ุฎุงุฑุฌุ ุจุงุฏ InnoDB ุจุงุดุฏ.

โ CREATE UNIQUE INDEX โ ุงุฌุงุฏ ุงูุฏฺฉุณ ฺฉุชุง
sql
Copy
Edit
CREATE UNIQUE INDEX email_index ON users (email);
ุงู ุฏุณุชูุฑ ุฑู ุณุชูู email ุฏุฑ ุฌุฏูู users ฺฉ ุงูุฏฺฉุณ ุงุฌุงุฏ ูโฺฉูุฏ.

UNIQUE: ุจู ุงู ูุนูุงุณุช ฺฉู ูฺ ุฏู ฺฉุงุฑุจุฑ ููโุชูุงููุฏ ุงูู ฺฉุณุงู ุฏุงุดุชู ุจุงุดูุฏ.

email_index: ูุงู ุฏูุฎูุงู ุงุณุช ฺฉู ุจุฑุง ุงูุฏฺฉุณ ุงูุชุฎุงุจ ุดุฏู (ูโุชูุงูุฏ ูุฑ ุงุณู ุจุงุดุฏ).

๐ ุงูุฏฺฉุณ ฺุณุชุ
ุงูุฏฺฉุณ (Index) ูุซู ููุฑุณุช ฺฉุชุงุจ ุงุณุช. ฺฉูฺฉ ูโฺฉูุฏ ูพุงฺฏุงู ุฏุงุฏู ุณุฑุนโุชุฑ ุฑฺฉูุฑุฏูุง ุฑุง ุจุฑ ุงุณุงุณ ฺฉ ููุฏ ูพุฏุง ฺฉูุฏ. ููุช UNIQUE ูู ุจุงุดุฏุ ุนูุงููโุจุฑ ุณุฑุนุชุ ุฌูู ุชฺฉุฑุงุฑ ุฏุงุฏูโูุง ุฑุง ูโฺฏุฑุฏ.

โ ALTER TABLE โ ุชุบุฑ ุฌุฏูู ููุฌูุฏ
ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ฺฉ ุณุชูู ุฌุฏุฏ:

sql
Copy
Edit
ALTER TABLE notes ADD COLUMN user_id INT UNSIGNED;
ุงู ุฏุณุชูุฑ ุจู ุฌุฏูู notes ฺฉ ุณุชูู ุฌุฏุฏ ุจู ูุงู user_id ุงุถุงูู ูโฺฉูุฏ.

ุงู ููุฏ ุจุฑุง ูุดุฎุตโฺฉุฑุฏู ุงู ุงุณุช ฺฉู ูุฑ ุงุฏุฏุงุดุช ูุชุนูู ุจู ฺฉุฏุงู ฺฉุงุฑุจุฑ ุงุณุช.

ุจุฑุง ุชุนุฑู ฺฉูุฏ ุฎุงุฑุฌ:

sql
Copy
Edit
ALTER TABLE notes
ADD CONSTRAINT fk_user_note
FOREIGN KEY (user_id)
REFERENCES users(id);
ADD CONSTRAINT fk_user_note: ฺฉ ูุญุฏูุฏุช (constraint) ุฌุฏุฏ ุจุง ูุงู fk_user_note ุชุนุฑู ูโุดูุฏ.

FOREIGN KEY (user_id): ูุดุฎุต ูโฺฉูุฏ ฺฉู ุณุชูู user_id ุฏุฑ ุฌุฏูู notes ุจูโุตูุฑุช ฺฉูุฏ ุฎุงุฑุฌ ุนูู ฺฉูุฏ.

REFERENCES users(id): ุนู ููุฏุงุฑ ุงู ุณุชูู ุจุงุฏ ุจุง ููุฏุงุฑ id ุฏุฑ ุฌุฏูู users ูุทุงุจูุช ุฏุงุดุชู ุจุงุดุฏ.

๐ ฺฉูุฏ ุฎุงุฑุฌ (Foreign Key):
ุจุฑุง ุงุฌุงุฏ ุงุฑุชุจุงุท ุจู ุฏู ุฌุฏูู ุงุณุชูุงุฏู ูโุดูุฏ. ุฏุฑ ุงู ูุซุงูุ ูุฑ ุงุฏุฏุงุดุช (note) ุจู ฺฉ ฺฉุงุฑุจุฑ (user) ูุชุตู ูโุดูุฏ.

โ๏ธ ุฎุทุง ูุนุฑูู errno: 150
ุงฺฏุฑ ููฺฏุงู ุงุถุงููโฺฉุฑุฏู ฺฉูุฏ ุฎุงุฑุฌ ุจุง ุงู ุฎุทุง ุฑูุจุฑู ุดุฏุฏ:

rust
Copy
Edit
Can't create table ... (errno: 150 "Foreign key constraint is incorrectly formed")
ุนูุชโูุง ุฑุงุฌ:

ููุน ุณุชููโูุง ุฏุฑ ุฏู ุฌุฏูู ฺฉ ูุณุช (ูุซูุงู ฺฉ INT ู ุฏฺฏุฑ INT UNSIGNED).

ุฌุฏููโูุง ุงุฒ ููุชูุฑ InnoDB ุงุณุชูุงุฏู ููโฺฉููุฏ.

ุฌุฏูู users ูููุฒ ุณุงุฎุชู ูุดุฏู ุง id ฺฉูุฏ ุงุตู ูุณุช.

ุณุน ฺฉุฑุฏุฏ ฺฉูุฏ ุฎุงุฑุฌ ุฑู ููุฏ ุจฺฏุฐุงุฑุฏ ฺฉู ุฏุงุฏูโูุง ูุงุณุงุฒฺฏุงุฑ ุฏุงุฑุฏ.